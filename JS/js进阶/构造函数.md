

## 八、javascript中构造函数的返回值问题和new对象的过程

1. 首先明确一点：javascript中构造函数是不需要有返回值的。
  这一点跟java很类似。可以认为构造函数和普通函数的最大差别就是：构造函数中没有return语句，普通函数可以有return语句；构造函数中会使用this关键字定义成员变量和成员方法，普通的函数不会使用this关键字定义成员变量和方法。
  ----其实也不太对吧,根本还是这个函数有没有被new...
2. 构造函数不需要显示的返回值。使用new来创建对象(调用构造函数)时，如果return的是非对象(数字、字符串、布尔类型等)会忽而略返回值;如果return的是对象，则返回该对象。

3. 下面简单介绍下，javascript中new对象的过程：如
  `var myObj = newPerson("aty",25);`
* 1.创建一个空的Object对象`var obj = new Object();`
* 2.将构造函数Person中this指向刚创建的obj对象
* 3.将创建的obj的__proto__指向构造函数Person的prototype。这一步是建立对象和原型直接的对应关系。firefox下通过对象的__proto__属性能够访问到原型，IE下则没有暴露出相应的属性。
执行构造函数Person()中的代码

4. 关于js构造函数返回值的详细解释：
* 不管是在java或.net或javascript中，构造函数的里面的this只的就是将要得到的对象本身，在new的时候开辟内存空间，这个空间肯定是个object然后和this相连，(javascript并且原型应用会把函数的prototype给新的对象)。但是不同的是java或.net如果你在构造函数里面写return是会发生编译期错误的，因为他知道这个是构造函数不应该有return关键字。而javascript不一样，他可以有，如果你在javascript构造函数中写return，return了对象的话，他就会舍弃原先的内存空间及this,并且不会原型引用当前函数的prototype，而是得到直接的返回值，也就说，如果一个带返回值的方法，不管你 new还是不new得到的都是返回值的内容。

```javascript
//例一
function Person(name,sex){
    this.name=name;
    this.sex=sex;
    return this.name;
}
var obj=new Person('li',1);
obj//Person {name: "li", sex: 1}

//例二
function Person(name,sex){
    this.name=name;
    this.sex=sex;
    return {"returnValue":11};
}
var obj=new Person('li',1);
obj//Object {returnValue: 11}

//例三
function Person(name,sex){
    this.name=name;
    this.sex=sex;
    return {"returnValue":11};
}
Person.prototype.cc=function(){
    console.log("console");
}
var obj=new Person('li',1);
obj//Object {returnValue: 11}
obj.cc//undefined

//例四
function Person(name,sex){
    this.name=name;
    this.sex=sex;
    return this.name;
}
Person.prototype.cc=function(){
    console.log("console");
}
var obj=new Person('li',1);
obj//Person {name: "li", sex: 1}
onj.cc()//console

```